# LLM-Powered Authentication Guide

YoFix includes powerful AI-driven authentication that can understand and interact with ANY login form without requiring CSS selectors or manual configuration.

## How It Works

The LLM authentication feature uses Claude AI to:
1. Analyze the DOM structure of login pages
2. Identify username/email and password fields
3. Locate submit buttons
4. Fill in credentials and submit forms
5. Handle various login flows automatically

## Configuration

### Basic Setup

```yaml
- uses: yofix/yofix@v1
  with:
    preview-url: ${{ steps.deploy.outputs.preview-url }}
    github-token: ${{ secrets.GITHUB_TOKEN }}
    claude-api-key: ${{ secrets.CLAUDE_API_KEY }}
    auth-email: ${{ secrets.TEST_EMAIL }}
    auth-password: ${{ secrets.TEST_PASSWORD }}
    auth-mode: 'llm'  # This enables AI-powered authentication
```

### Authentication Modes

YoFix supports three authentication modes:

1. **`llm` (default)** - AI-powered authentication that works with any login form
2. **`selectors`** - Traditional CSS selector-based authentication
3. **`smart`** - Tries multiple strategies including tab navigation

## Example Usage

### Standard Login Forms

```yaml
# Works with any standard login form
auth-email: 'test@example.com'
auth-password: 'secure123'
auth-login-url: '/login'
auth-mode: 'llm'
```

### Custom Login Pages

```yaml
# Handles custom login URLs
auth-login-url: '/auth/signin'
auth-mode: 'llm'
```

### Multi-Step Authentication

The LLM can handle complex multi-step authentication flows:
- Separate username and password pages
- OAuth redirects
- Custom authentication workflows

## Advantages

### 1. No Selector Maintenance
Traditional automation breaks when UI changes. LLM authentication adapts automatically.

### 2. Universal Compatibility
Works with:
- React/Vue/Angular forms
- Server-side rendered pages
- Dynamic forms
- Custom UI components
- Shadow DOM elements

### 3. Natural Understanding
The AI understands login forms conceptually:
- "Email", "Username", "User ID" fields
- "Password", "PIN", "Secret" fields
- "Login", "Sign In", "Submit" buttons
- "Remember me" checkboxes
- Error messages

## Debugging

Enable debug mode to see what the AI is doing:

```yaml
- uses: yofix/yofix@v1
  with:
    # ... other inputs
    debug: true
```

This will show:
- DOM elements the AI can see
- Actions generated by the AI
- Step-by-step execution

## Fallback Strategies

If LLM authentication fails, YoFix automatically tries:
1. Smart selector strategies
2. Tab-order navigation
3. Visual element detection

## Security

- Credentials are only used during test execution
- No credentials are stored or logged
- All authentication happens in isolated browser contexts

## Bot Commands

You can also trigger authentication tests via bot commands:

```
@yofix test login flow with AI authentication
@yofix verify protected routes work correctly
```

## Troubleshooting

### Common Issues

1. **API Key Missing**
   ```
   Error: Claude API key not available for LLM authentication
   ```
   Solution: Ensure `CLAUDE_API_KEY` is set

2. **Complex Forms**
   Some forms may require custom handling. Use debug mode to understand what the AI sees.

3. **Rate Limits**
   The LLM has rate limits. For high-frequency testing, consider caching authentication state.

## Best Practices

1. **Use Dedicated Test Accounts**
   Create accounts specifically for automated testing

2. **Test Authentication First**
   Run a simple auth test before complex visual tests

3. **Monitor Success Rates**
   Track authentication success to identify problematic forms

4. **Combine with Visual Testing**
   After authentication, run comprehensive visual tests on protected routes